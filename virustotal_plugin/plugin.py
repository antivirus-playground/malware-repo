import logging

from mwdb.core.plugins import PluginAppContext, PluginHookHandler
from mwdb.model import File

logger = logging.getLogger("mwdb.plugin.virustotal")


class VTHookHandler(PluginHookHandler):
    def on_created_file(self, file: File):
        file.add_metakey("virustotal", file.md5)

def entrypoint(app_context: PluginAppContext):
    logger.info("plugin started!")
    app_context.register_hook_handler(VTHookHandler)
